<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Giỏ hàng - Tạp hóa Bà Trâm</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        --primary: #1581fc;
        --secondary: #2c3e50;
        --success: #2ecc71;
        --danger: #e74c3c;
        --light: #ecf0f1;
        --dark: #2c3e50;
      }
/* ===== CĂN CHỈNH HEADER ===== */
header {
  display: flex;
  align-items: center;
  padding: 10px 15px;
  background-color: var(--primary);
  position: relative;
  min-height: 60px;
}

.header-center {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
  width: max-content;
  max-width: 70%;
}

.main-title {
  font-size: 1.2rem;
  font-weight: bold;
  line-height: 1.3;
  white-space: nowrap;
}

.sub-title {
  font-size: 0.7rem;
  line-height: 1.2;
}

.back-button {
  position: relative; /* Đổi thành relative để tự co giãn */
  margin-right: auto; /* Đẩy về bên trái */
  z-index: 1;
  /* Giữ nguyên các style khác */
}

/* ===== MOBILE RESPONSIVE ===== */
@media (max-width: 768px) {
  .header-center {
    max-width: 60%;
  }
  
  .main-title {
    font-size: 1rem;
  }
  
  .sub-title {
    font-size: 0.6rem;
  }
  
  .back-button {
    padding: 5px 8px;
    font-size: 0.8rem;
  }
}
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        color: #333;
        background-color: #f9f9f9;
        margin: 0;
        padding: 0;
      }

      header {
        position: relative;
        padding: 1rem;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 80px;
        background-color: var(--primary);
        color: white;
      }

      .header-content {
        flex: 1;
        min-width: 300px;
        padding: 0 100px;
        margin: 0 10px;
      }

      .header-title {
        margin: 0;
        font-size: 1.5rem;
        white-space: normal;
        word-break: break-word;
        padding: 0 20px;
      }

      .back-button {
        position: absolute;
        left: 20px;
        top: 50%;
        transform: translateY(-50%);
        color: white;
        background: var(--dark);
        padding: 8px 15px;
        border-radius: 4px;
        cursor: pointer;
        text-decoration: none;
        font-size: 0.9rem;
        white-space: nowrap;
        z-index: 1;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .cart-container {
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        padding: 20px;
        margin-top: 30px;
        overflow-x: auto;
        max-width: 100%;
      }

      .cart-items {
        width: 100%;
        border-collapse: collapse;
        min-width: 600px;
      }

      .cart-items th,
      .cart-items td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }

      .cart-items th {
        background-color: #f2f2f2;
        position: sticky;
        top: 0;
      }

      .cart-items td {
        vertical-align: middle;
      }

      .item-img {
        width: 80px;
        height: 80px;
        object-fit: contain;
        border: 1px solid #ddd;
        border-radius: 5px;
        background-color: white;
      }

      .product-info {
        display: flex;
        align-items: center;
        gap: 15px;
        min-width: 200px;
      }

      .product-name {
        word-break: break-word;
      }

      .quantity-control {
        display: flex;
        align-items: center;
      }

      .quantity-btn {
        background: var(--light);
        border: none;
        width: 30px;
        height: 30px;
        cursor: pointer;
        font-weight: bold;
      }

      .quantity-input {
        width: 50px;
        text-align: center;
        margin: 0 5px;
        padding: 5px;
        border: 1px solid #ddd;
        border-radius: 4px;
      }

      .remove-btn {
        color: var(--danger);
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1.2rem;
      }

      .cart-summary {
        margin-top: 30px;
        text-align: right;
        padding-top: 20px;
        border-top: 1px solid #eee;
      }

      .action-buttons {
        display: flex;
        justify-content: flex-end;
        gap: 15px;
        margin-top: 20px;
      }

      .checkout-btn,
      .continue-btn {
        background-color: var(--primary);
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 1rem;
        transition: background-color 0.3s;
        text-decoration: none;
        display: inline-block;
      }

      .continue-btn {
        background-color: var(--success);
      }

      .checkout-btn:hover,
      .continue-btn:hover {
        opacity: 0.9;
      }

      .empty-cart {
        text-align: center;
        padding: 40px 0;
      }

      .empty-cart i {
        font-size: 3rem;
        color: #ccc;
        margin-bottom: 15px;
      }

      footer {
        background-color: var(--dark);
        color: white;
        text-align: center;
        padding: 20px;
        margin-top: 40px;
      }

      @media (max-width: 768px) {
        .header-content {
          padding: 0 20px;
          margin: 0 60px;
        }

        .header-title {
          font-size: 1.1rem;
          padding: 0 10px;
        }

        .back-button {
          padding: 6px 8px;
          font-size: 0.8rem;
          left: 5px;
        }

        .product-info {
          flex-direction: column;
          align-items: flex-start;
          gap: 8px;
        }

        .item-img {
          width: 60px;
          height: 60px;
        }

        .action-buttons {
          flex-direction: column;
          gap: 10px;
        }

        .checkout-btn,
        .continue-btn {
          width: 100%;
          padding: 10px;
        }
      }

      @media (max-width: 576px) {
        .header-title {
          font-size: 1.1rem;
        }

        .back-button {
          padding: 6px 8px;
          font-size: 0.8rem;
        }
      }

      @media (max-width: 480px) {
        .header-title {
          font-size: 1rem;
        }

        .back-button {
          max-width: 80px;
          overflow: hidden;
          text-overflow: ellipsis;
        }
      }
    </style>
  </head>

  <body>
<header>
            <div class="header-content">
                <div class="header-titles">
                    <h1 class="header-title">TẠP HÓA DEMO - DEMO LÀ KHÔNG CÓ THẬT</h1>
                    <h5 class="header-title">Nó được tạo ra nhằm mục đích nghiên cứu và phát triển</h5>
                </div>

                <div class="header-buttons">
                    <a href="cart.html" class="header-btn cart-icon">
                        <i class="fas fa-shopping-cart"></i> Giỏ Hàng
                        <span class="cart-count">0</span>
                    </a>
                    <a href="checkout.html" class="header-btn" id="checkout-btn">
                        <i class="fas fa-credit-card"></i> Thanh Toán
                    </a>
                    <a href="naptien.html" class="header-btn">
                        <i class="fas fa-qrcode"></i> QR Ngân Hàng
                    </a>
                </div>
            </div>
        </header>

    <div class="container">
      <div class="cart-container">
        <h2><i class="fas fa-shopping-cart"></i> Giỏ hàng của bạn</h2>

        <table class="cart-items">
          <thead>
            <tr>
              <th>Sản phẩm</th>
              <th>Giá</th>
              <th>Số lượng</th>
              <th>Tổng</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="cart-body"></tbody>
        </table>

        <div class="cart-summary">
          <h3>
            Tổng cộng:
            <span
              id="total-price"
              style="color: var(--primary); font-weight: bold"
              >0 ₫</span
            >
          </h3>
          <div class="action-buttons">
            <a href="https://mhcomputer.org/" class="continue-btn">
              <i class="fas fa-shopping-bag"></i> Tiếp tục mua hàng
            </a>
            <a href="https://mhcomputer.org/checkout.html" class="checkout-btn">
              <i class="fas fa-credit-card"></i> Thanh toán
            </a>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <p>Copyright © 2025 Đào Minh Hải - Đừng tin vào những gì nhìn thấy</p>
      <p>Powered by Demo by DMH</p>
    </footer>

    <script>
      let cart = JSON.parse(localStorage.getItem('shopping_cart')) || [];
      const CART_STORAGE_KEY = 'shopping_cart';
      const fallbackImageUrl =
        'https://via.placeholder.com/80?text=Image+Error';

      const productImages = {
        101: 'https://i.imgur.com/VPBhiHd.png',
        102: 'https://i.imgur.com/ZEL4bLO.jpg',
        103: 'https://i.imgur.com/TKreRzg.jpg',
        104: 'https://i.imgur.com/H0V9SFG.jpg',
        105: 'https://i.imgur.com/5fTijGk.jpg',
        106: 'https://i.imgur.com/SgOahXx.jpg',
      };

      const debounce = (func, wait) => {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      };

      function renderCart() {
        const cartBody = document.getElementById('cart-body');
        cartBody.innerHTML = '';
        let totalPrice = 0;

        if (!cart?.length) {
          cartBody.innerHTML = `
          <tr>
            <td colspan="5" class="empty-cart">
              <i class="fas fa-shopping-cart"></i>
              <p>Giỏ hàng trống</p>
              <a href="/" class="continue-btn">Tiếp tục mua sắm</a>
            </td>
          </tr>`;
          document.getElementById('total-price').textContent = '0 ₫';
          return;
        }

        cart.forEach((item, index) => {
          const subtotal = item.price * item.quantity;
          totalPrice += subtotal;
          const itemImage =
            productImages[item.id] || item.img || fallbackImageUrl;

          cartBody.innerHTML += `
          <tr>
            <td>
              <div class="product-info">
                <img src="${itemImage}" class="item-img" alt="${item.name}" 
                     onerror="this.src='${fallbackImageUrl}'">
                <span class="product-name">${item.name}</span>
              </div>
            </td>
            <td>${item.price?.toLocaleString('vi-VN') || '0'} ₫</td>
            <td>
              <div class="quantity-control">
                <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">-</button>
                <input type="number" value="${
                  item.quantity
                }" class="quantity-input" readonly>
                <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
              </div>
            </td>
            <td>${subtotal.toLocaleString('vi-VN')} ₫</td>
            <td>
              <button class="remove-btn" onclick="removeItem(${index})">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          </tr>`;
        });

        document.getElementById(
          'total-price'
        ).textContent = `${totalPrice.toLocaleString('vi-VN')} ₫`;
      }

      function saveCart() {
        localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(cart));
        renderCart();
      }

      // Listen for storage changes from other tabs/windows
      window.addEventListener('storage', function (e) {
        if (e.key === CART_STORAGE_KEY) {
          cart = JSON.parse(e.newValue || '[]');
          renderCart();
        }
      });

      function updateQuantity(index, change) {
        if (index >= 0 && index < cart.length) {
          cart[index].quantity = Math.max(1, cart[index].quantity + change);
          saveCart();
        }
      }

      function removeItem(index) {
        const confirmModal = document.createElement('div');
        confirmModal.className = 'confirm-modal';
        confirmModal.innerHTML = `
        <div class="modal-content">
          <p>Bạn có chắc chắn muốn xóa sản phẩm này?</p>
          <div class="modal-actions">
            <button id="confirm-delete" class="danger-btn">Xóa</button>
            <button id="cancel-delete" class="normal-btn">Hủy</button>
          </div>
        </div>
      `;

        document.body.appendChild(confirmModal);

        document.getElementById('confirm-delete').onclick = () => {
          cart.splice(index, 1);
          saveCart();
          document.body.removeChild(confirmModal);
        };

        document.getElementById('cancel-delete').onclick = () => {
          document.body.removeChild(confirmModal);
        };
      }

      document.addEventListener('DOMContentLoaded', () => {
        try {
          const savedCart = localStorage.getItem(CART_STORAGE_KEY);
          if (savedCart) {
            cart = JSON.parse(savedCart);
          }
        } catch (error) {
          console.error('Failed to load cart:', error);
          cart = [];
        }
        renderCart();
      });
    </script>
  </body>
</html>
